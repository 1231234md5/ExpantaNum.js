//Compressed with UglifyJS 3 https://skalman.github.io/UglifyJS-online/
(function(globalScope){"use strict";var ExpantaNum={maxOps:1e3,serializeMode:0,debug:0},external=true,expantaNumError="[ExpantaNumError] ",invalidArgument=expantaNumError+"Invalid argument: ",isExpantaNum=/^[-\+]*(Infinity|NaN|(J+|J\^\d+ )?(10(\^+|\{[1-9]\d*\})|\(10(\^+|\{[1-9]\d*\})\)\^[1-9]\d* )*((\d+(\.\d*)?|\d*\.\d+)?([Ee][-\+]*))*(0|\d+(\.\d*)?|\d*\.\d+))$/,MAX_SAFE_INTEGER=9007199254740991,MAX_E=Math.log10(MAX_SAFE_INTEGER),P={},Q={},R={};R.ZERO=0;R.ONE=1;R.E=Math.E;R.LN2=Math.LN2;R.LN10=Math.LN10;R.LOG2E=Math.LOG2E;R.LOG10E=Math.LOG10E;R.PI=Math.PI;R.SQRT1_2=Math.SQRT1_2;R.SQRT2=Math.SQRT2;R.MAX_SAFE_INTEGER=MAX_SAFE_INTEGER;R.MIN_SAFE_INTEGER=Number.MIN_SAFE_INTEGER;R.NaN=Number.NaN;R.NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY;R.POSITIVE_INFINITY=Number.POSITIVE_INFINITY;R.E_MAX_SAFE_INTEGER="e"+MAX_SAFE_INTEGER;R.EE_MAX_SAFE_INTEGER="ee"+MAX_SAFE_INTEGER;R.TETRATED_MAX_SAFE_INTEGER="10^^"+MAX_SAFE_INTEGER;R.GRAHAMS_NUMBER="J^63 10^^^(10^)^7625597484984 3638334640023.7783";P.absoluteValue=P.abs=function(){var x=this.clone();x.sign=1;return x};Q.absoluteValue=Q.abs=function(x){return new ExpantaNum(x).abs()};P.negate=P.neg=function(){var x=this.clone();x.sign=x.sign*-1;return x};Q.negate=Q.neg=function(x){return new ExpantaNum(x).neg()};P.compareTo=P.cmp=function(other){if(!(other instanceof ExpantaNum))other=new ExpantaNum(other);if(isNaN(this.array[0][1])||isNaN(other.array[0][1]))return NaN;if(this.array[0][1]==Infinity&&other.array[0][1]!=Infinity)return this.sign;if(this.array[0][1]!=Infinity&&other.array[0][1]==Infinity)return-other.sign;if(this.array.length==1&&this.array[0][1]===0&&other.array.length==1&&other.array[0][1]===0)return 0;if(this.sign!=other.sign)return this.sign;var m=this.sign;var r;if(this.layer>other.layer)r=1;else if(this.layer<other.layer)r=-1;else{var e,f;for(var i=0,l=Math.min(this.array.length,other.array.length);i<l;++i){e=this.array[this.array.length-1-i];f=other.array[other.array.length-1-i];if(e[0]>f[0]||e[0]==f[0]&&e[1]>f[1]){r=1;break}else if(e[0]<f[0]||e[0]==f[0]&&e[1]<f[1]){r=-1;break}}if(r===undefined){if(this.array.length==other.array.length){r=0}else if(this.array.length>other.array.length){e=this.array[this.array.length-l];if(e[0]>=1||e[1]>10){r=1}else{r=-1}}else{e=other.array[other.array.length-l];if(e[0]>=1||e[1]>10){r=-1}else{r=1}}}}return r*m};Q.compare=Q.cmp=function(x,y){return new ExpantaNum(x).cmp(y)};P.greaterThan=P.gt=function(other){return this.cmp(other)>0};Q.greaterThan=Q.gt=function(x,y){return new ExpantaNum(x).gt(y)};P.greaterThanOrEqualTo=P.gte=function(other){return this.cmp(other)>=0};Q.greaterThanOrEqualTo=Q.gte=function(x,y){return new ExpantaNum(x).gte(y)};P.lessThan=P.lt=function(other){return this.cmp(other)<0};Q.lessThan=Q.lt=function(x,y){return new ExpantaNum(x).lt(y)};P.lessThanOrEqualTo=P.lte=function(other){return this.cmp(other)<=0};Q.lessThanOrEqualTo=Q.lte=function(x,y){return new ExpantaNum(x).lte(y)};P.equalsTo=P.equal=P.eq=function(other){return this.cmp(other)===0};Q.equalsTo=Q.equal=Q.eq=function(x,y){return new ExpantaNum(x).eq(y)};P.notEqualsTo=P.notEqual=P.neq=function(other){return this.cmp(other)!==0};Q.notEqualsTo=Q.notEqual=Q.neq=function(x,y){return new ExpantaNum(x).neq(y)};P.minimum=P.min=function(other){return this.lt(other)?this.clone():new ExpantaNum(other)};Q.minimum=Q.min=function(x,y){return new ExpantaNum(x).min(y)};P.maximum=P.max=function(other){return this.gt(other)?this.clone():new ExpantaNum(other)};Q.maximum=Q.max=function(x,y){return new ExpantaNum(x).max(y)};P.isPositive=P.ispos=function(){return this.gt(ExpantaNum.ZERO)};Q.isPositive=Q.ispos=function(x){return new ExpantaNum(x).ispos()};P.isNegative=P.isneg=function(){return this.lt(ExpantaNum.ZERO)};Q.isNegative=Q.isneg=function(x){return new ExpantaNum(x).isneg()};P.isNaN=function(){return isNaN(this.array[0][1])};Q.isNaN=function(x){return new ExpantaNum(x).isNaN()};P.isFinite=function(){return isFinite(this.array[0][1])};Q.isFinite=function(x){return new ExpantaNum(x).isFinite()};P.isInfinite=function(){return this.array[0][1]==Infinity};Q.isInfinite=function(x){return new ExpantaNum(x).isInfinite()};P.isInteger=P.isint=function(){if(this.sign==-1)return this.abs().isint();if(this.gt(ExpantaNum.MAX_SAFE_INTEGER))return true;return Number.isInteger(this.toNumber())};Q.isInteger=Q.isint=function(x){return new ExpantaNum(x).isint()};P.floor=function(){if(this.isInteger())return this.clone();return new ExpantaNum(Math.floor(this.toNumber()))};Q.floor=function(x){return new ExpantaNum(x).floor()};P.ceiling=P.ceil=function(){if(this.isInteger())return this.clone();return new ExpantaNum(Math.ceil(this.toNumber()))};Q.ceiling=Q.ceil=function(x){return new ExpantaNum(x).ceil()};P.round=function(){if(this.isInteger())return this.clone();return new ExpantaNum(Math.round(this.toNumber()))};Q.round=function(x){return new ExpantaNum(x).round()};P.plus=P.add=function(other){var x=this.clone();other=new ExpantaNum(other);if(ExpantaNum.debug>=ExpantaNum.NORMAL)console.log(this+"+"+other);if(x.sign==-1)return x.neg().add(other.neg()).neg();if(other.sign==-1)return x.sub(other.neg());if(x.eq(ExpantaNum.ZERO))return other;if(other.eq(ExpantaNum.ZERO))return x;if(x.isNaN()||other.isNaN()||x.isInfinite()&&other.isInfinite()&&x.eq(other.neg()))return ExpantaNum.NaN.clone();if(x.isInfinite())return x;if(other.isInfinite())return other;var p=x.min(other);var q=x.max(other);var op0=q.operator(0);var op1=q.operator(1);var t;if(q.gt(ExpantaNum.E_MAX_SAFE_INTEGER)||q.div(p).gt(ExpantaNum.MAX_SAFE_INTEGER)){t=q}else if(!op1){t=new ExpantaNum(x.toNumber()+other.toNumber())}else if(op1==1){var a=p.operator(1)?p.operator(0):Math.log10(p.operator(0));t=new ExpantaNum([a+Math.log10(Math.pow(10,op0-a)+1),1])}p=q=null;return t};Q.plus=Q.add=function(x,y){return new ExpantaNum(x).add(y)};P.minus=P.sub=function(other){var x=this.clone();other=new ExpantaNum(other);if(ExpantaNum.debug>=ExpantaNum.NORMAL)console.log(x+"-"+other);if(x.sign==-1)return x.neg().sub(other.neg()).neg();if(other.sign==-1)return x.add(other.neg());if(x.eq(other))return ExpantaNum.ZERO.clone();if(other.eq(ExpantaNum.ZERO))return x;if(x.isNaN()||other.isNaN()||x.isInfinite()&&other.isInfinite())return ExpantaNum.NaN.clone();if(x.isInfinite())return x;if(other.isInfinite())return other.neg();var p=x.min(other);var q=x.max(other);var n=other.gt(x);var op0=q.operator(0);var op1=q.operator(1);var t;if(q.gt(ExpantaNum.E_MAX_SAFE_INTEGER)||q.div(p).gt(ExpantaNum.MAX_SAFE_INTEGER)){t=q;t=n?t.neg():t}else if(!op1){t=new ExpantaNum(x.toNumber()-other.toNumber())}else if(op1==1){var a=p.operator(1)?p.operator(0):Math.log10(p.operator(0));t=new ExpantaNum([a+Math.log10(Math.pow(10,op0-a)-1),1]);t=n?t.neg():t}p=q=null;return t};Q.minus=Q.sub=function(x,y){return new ExpantaNum(x).sub(y)};P.times=P.mul=function(other){var x=this.clone();other=new ExpantaNum(other);if(ExpantaNum.debug>=ExpantaNum.NORMAL)console.log(x+"*"+other);if(x.sign*other.sign==-1)return x.abs().mul(other.abs()).neg();if(x.sign==-1)return x.abs().mul(other.abs());if(x.isNaN()||other.isNaN()||x.eq(ExpantaNum.ZERO)&&other.isInfinite()||x.isInfinite()&&other.abs().eq(ExpantaNum.ZERO))return ExpantaNum.NaN.clone();if(other.eq(ExpantaNum.ZERO))return ExpantaNum.ZERO.clone();if(other.eq(ExpantaNum.ONE))return x.clone();if(x.isInfinite())return x;if(other.isInfinite())return other;if(x.max(other).gt(ExpantaNum.EE_MAX_SAFE_INTEGER))return x.max(other);var n=x.toNumber()*other.toNumber();if(n<=MAX_SAFE_INTEGER)return new ExpantaNum(n);return ExpantaNum.pow(10,x.log10().add(other.log10()))};Q.times=Q.mul=function(x,y){return new ExpantaNum(x).mul(y)};P.divide=P.div=function(other){var x=this.clone();other=new ExpantaNum(other);if(ExpantaNum.debug>=ExpantaNum.NORMAL)console.log(x+"/"+other);if(x.sign*other.sign==-1)return x.abs().div(other.abs()).neg();if(x.sign==-1)return x.abs().div(other.abs());if(x.isNaN()||other.isNaN()||x.isInfinite()&&other.isInfinite()||x.eq(ExpantaNum.ZERO)&&other.eq(ExpantaNum.ZERO))return ExpantaNum.NaN.clone();if(other.eq(ExpantaNum.ZERO))return ExpantaNum.POSITIVE_INFINITY.clone();if(other.eq(ExpantaNum.ONE))return x.clone();if(x.eq(other))return ExpantaNum.ONE.clone();if(x.isInfinite())return x;if(other.isInfinite())return ExpantaNum.ZERO.clone();if(x.max(other).gt(ExpantaNum.EE_MAX_SAFE_INTEGER))return x.gt(other)?x.clone():ExpantaNum.ZERO.clone();var n=x.toNumber()/other.toNumber();if(n<=MAX_SAFE_INTEGER)return new ExpantaNum(n);var pw=ExpantaNum.pow(10,x.log10().sub(other.log10()));var fp=pw.floor();if(pw.sub(fp).lt(new ExpantaNum(1e-9)))return fp;return pw};Q.divide=Q.div=function(x,y){return new ExpantaNum(x).div(y)};P.reciprocate=P.rec=function(){if(ExpantaNum.debug>=ExpantaNum.NORMAL)console.log(this+"^-1");if(this.isNaN()||this.eq(ExpantaNum.ZERO))return ExpantaNum.NaN.clone();if(this.abs().gt("2e323"))return ExpantaNum.ZERO.clone();return new ExpantaNum(1/this)};Q.reciprocate=Q.rec=function(x){return new ExpantaNum(x).rec()};P.modular=P.mod=function(other){other=new ExpantaNum(other);if(other.eq(ExpantaNum.ZERO))return ExpantaNum.ZERO.clone();if(this.sign*other.sign==-1)return this.abs().mod(other.abs()).neg();if(this.sign==-1)return this.abs().mod(other.abs());return this.sub(this.div(other).floor().mul(other))};Q.modular=Q.mod=function(x,y){return new ExpantaNum(x).mod(y)};var f_gamma=function(n){if(!isFinite(n))return n;if(n<-50){if(n==Math.trunc(n))return Number.NEGATIVE_INFINITY;return 0}var scal1=1;while(n<10){scal1=scal1*n;++n}n-=1;var l=.9189385332046727;l+=(n+.5)*Math.log(n);l-=n;var n2=n*n;var np=n;l+=1/(12*np);np*=n2;l+=1/(360*np);np*=np*n2;l+=1/(1260*np);np*=n2;l+=1/(1680*np);np*=n2;l+=1/(1188*np);np*=n2;l+=691/(360360*np);np*=n2;l+=7/(1092*np);np*=n2;l+=3617/(122400*np);return Math.exp(l)/scal1};P.gamma=function(){var x=this.clone();if(x.gt(ExpantaNum.TETRATED_MAX_SAFE_INTEGER))return x;if(x.gt(ExpantaNum.E_MAX_SAFE_INTEGER))return ExpantaNum.exp(x);if(x.gt(ExpantaNum.MAX_SAFE_INTEGER))return ExpantaNum.exp(ExpantaNum.mul(x,ExpantaNum.ln(x).sub(1)));var n=x.operator(0);if(n>1){if(n<24)return new ExpantaNum(f_gamma(x.sign*n));var t=n-1;var l=.9189385332046727;l+=(t+.5)*Math.log(t);l-=t;var n2=t*t;var np=t;var lm=12*np;var adj=1/lm;var l2=l+adj;if(l2==l)return ExpantaNum.exp(l);l=l2;np*=n2;lm=360*np;adj=1/lm;l2=l-adj;if(l2==l)return ExpantaNum.exp(l);l=l2;np*=n2;lm=1260*np;var lt=1/lm;l+=lt;np*=n2;lm=1680*np;lt=1/lm;l-=lt;return ExpantaNum.exp(l)}else return this.rec()};Q.gamma=function(x){return new ExpantaNum(x).gamma()};Q.factorials=[1,1,2,6,24,120,720,5040,40320,362880,3628800,39916800,479001600,6227020800,87178291200,1307674368e3,20922789888e3,355687428096e3,6402373705728e3,0x1b02b9306890000,243290200817664e4,5109094217170944e4,11240007277776077e5,2585201673888498e7,6204484017332394e8,15511210043330986e9,40329146112660565e10,10888869450418352e12,30488834461171387e13,8.841761993739702e30,26525285981219107e16,8222838654177922e18,2631308369336935e20,8683317618811886e21,29523279903960416e22,1.0333147966386145e40,37199332678990125e25,13763753091226346e27,5230226174666011e29,20397882081197444e30,8159152832478977e32,3345252661316381e34,140500611775288e37,6041526306337383e37,2658271574788449e39,11962222086548019e40,5502622159812089e42,25862324151116818e43,12413915592536073e45,6082818640342675e47,30414093201713376e48,15511187532873822e50,8065817517094388e52,42748832840600255e53,2308436973392414e56,12696403353658276e57,7109985878048635e59,40526919504877214e60,23505613312828785e62,1.3868311854568984e80,832098711274139e67,5075802138772248e68,3146997326038794e70,198260831540444e73,12688693218588417e73,8.247650592082472e90,5443449390774431e77,3647111091818868e79,24800355424368305e80,1711224524281413e83,1.1978571669969892e100,8504785885678623e86,61234458376886085e87,44701154615126844e89,3307885441519386e92,248091408113954e95,18854947016660504e95,14518309202828587e97,11324281178206297e99,8946182130782976e101,7156945704626381e103,5.797126020747368e120,4753643337012842e107,3945523969720659e109,3314240134565353e111,281710411438055e114,2.4227095383672734e130,2107757298379528e117,18548264225739844e118,1650795516090846e121,14857159644817615e122,1.352001527678403e140,12438414054641308e126,11567725070816416e128,1087366156656743e131,1032997848823906e133,9916779348709496e134,9619275968248212e136,9426890448883248e138,9332621544394415e140,9332621544394415e142,942594775983836e145,9614466715035127e146,990290071648618e149,10299016745145628e150,1081396758240291e153,1.1462805637347084e170,1226520203196138e157,1324641819451829e159,14438595832024937e160,1588245541522743e163,1.7629525510902446e180,1974506857221074e167,22311927486598138e168,25435597334721877e170,2925093693493016e173,3.393108684451898e190,3969937160808721e177,4684525849754291e179,5574585761207606e181,6689502913449127e183,8.094298525273444e200,9875044200833601e187,1214630436702533e190,1506141741511141e192,1882677176888926e194,2372173242880047e196,30126600184576594e197,3856204823625804e200,4974504222477287e202,6466855489220474e204,847158069087882e207,11182486511960043e208,14872707060906857e210,19929427461615188e212,2.6904727073180504e230,3659042881952549e217,5012888748274992e219,6917786472619489e221,9615723196941089e223,13462012475717526e225,1898143759076171e228,2695364137888163e230,3854370717180073e232,55502938327393044e233,8047926057471992e236,11749972043909107e238,1727245890454639e241,25563239178728654e242,3.80892263763057e260,5713383956445855e247,862720977423324e250,13113358856834524e251,20063439050956823e253,30897696138473508e255,4789142901463394e258,7471062926282894e260,11729568794264145e262,1.853271869493735e280,29467022724950384e266,47147236359920616e268,7590705053947219e271,12296942187394494e273,20044015765453026e275,3287218585534296e278,5423910666131589e280,9003691705778438e282,1.503616514864999e300,25260757449731984e286,4269068009004705e289,7257415615307999e291];P.factorial=P.fact=function(){var x=this.clone();var f=ExpantaNum.factorials;if(x.lt(ExpantaNum.ZERO)||!x.isint())return x.add(1).gamma();if(x.lte(170))return new ExpantaNum(f[+x]);var errorFixer=1;var e=+x;if(e<500)e+=163879/209018880*Math.pow(e,5);if(e<1e3)e+=-571/2488320*Math.pow(e,4);if(e<5e4)e+=-139/51840*Math.pow(e,3);if(e<1e7)e+=1/288*Math.pow(e,2);if(e<1e20)e+=1/12*e;return x.div(ExpantaNum.E).pow(x).mul(x.mul(ExpantaNum.PI).mul(2).sqrt()).times(errorFixer)};Q.factorial=Q.fact=function(x){return new ExpantaNum(x).fact()};P.toPower=P.pow=function(other){other=new ExpantaNum(other);if(ExpantaNum.debug>=ExpantaNum.NORMAL)console.log(this+"^"+other);if(other.eq(ExpantaNum.ZERO))return ExpantaNum.ONE.clone();if(other.eq(ExpantaNum.ONE))return this.clone();if(other.lt(ExpantaNum.ZERO))return this.pow(other.neg()).rec();if(this.lt(ExpantaNum.ZERO)&&other.isint()){if(other.mod(2).lt(ExpantaNum.ONE))return this.abs().pow(other);return this.abs().pow(other).neg()}if(this.lt(ExpantaNum.ZERO))return ExpantaNum.NaN.clone();if(this.eq(ExpantaNum.ONE))return ExpantaNum.ONE.clone();if(this.eq(ExpantaNum.ZERO))return ExpantaNum.ZERO.clone();if(this.max(other).gt(ExpantaNum.TETRATED_MAX_SAFE_INTEGER))return this.max(other);if(this.eq(10)){if(other.gt(ExpantaNum.ZERO)){other.operator(1,other.operator(1)+1||1);other.standardize();return other}else{return new ExpantaNum(Math.pow(10,other.toNumber()))}}if(other.lt(ExpantaNum.ONE))return this.root(other.rec());var n=Math.pow(this.toNumber(),other.toNumber());if(n<=MAX_SAFE_INTEGER)return new ExpantaNum(n);return ExpantaNum.pow(10,this.log10().mul(other))};Q.toPower=Q.pow=function(x,y){return new ExpantaNum(x).pow(y)};P.exponential=P.exp=function(){return ExpantaNum.pow(Math.E,this)};Q.exponential=Q.exp=function(x){return ExpantaNum.pow(Math.E,x)};P.squareRoot=P.sqrt=function(){return this.root(2)};Q.squareRoot=Q.sqrt=function(x){return new ExpantaNum(x).root(2)};P.cubeRoot=P.cbrt=function(){return this.root(3)};Q.cubeRoot=Q.cbrt=function(x){return new ExpantaNum(x).root(3)};P.root=function(other){other=new ExpantaNum(other);if(ExpantaNum.debug>=ExpantaNum.NORMAL)console.log(this+"root"+other);if(other.eq(ExpantaNum.ONE))return this.clone();if(other.lt(ExpantaNum.ZERO))return this.root(other.neg()).rec();if(other.lt(ExpantaNum.ONE))return this.pow(other.rec());if(this.lt(ExpantaNum.ZERO)&&other.isint()&&other.mod(2).eq(ExpantaNum.ONE))return this.neg().root(other).neg();if(this.lt(ExpantaNum.ZERO))return ExpantaNum.NaN.clone();if(this.eq(ExpantaNum.ONE))return ExpantaNum.ONE.clone();if(this.eq(ExpantaNum.ZERO))return ExpantaNum.ZERO.clone();if(this.max(other).gt(ExpantaNum.TETRATED_MAX_SAFE_INTEGER))return this.gt(other)?this.clone():ExpantaNum.ZERO.clone();return ExpantaNum.pow(10,this.log10().div(other))};Q.root=function(x,y){return new ExpantaNum(x).root(y)};P.generalLogarithm=P.log10=function(){var x=this.clone();if(ExpantaNum.debug>=ExpantaNum.NORMAL)console.log("log"+this);if(x.lt(ExpantaNum.ZERO))return ExpantaNum.NaN.clone();if(x.eq(ExpantaNum.ZERO))return ExpantaNum.NEGATIVE_INFINITY.clone();if(x.lte(ExpantaNum.MAX_SAFE_INTEGER))return new ExpantaNum(Math.log10(x.toNumber()));if(!x.isFinite())return x;if(x.gt(ExpantaNum.TETRATED_MAX_SAFE_INTEGER))return x;x.operator(1,x.operator(1)-1);return x.standardize()};Q.generalLogarithm=Q.log10=function(x){return new ExpantaNum(x).log10()};P.logarithm=P.logBase=function(base){if(base===undefined)base=Math.E;return this.log10().div(ExpantaNum.log10(base))};Q.logarithm=Q.logBase=function(x,base){return new ExpantaNum(x).logBase(base)};P.naturalLogarithm=P.log=P.ln=function(){return this.logBase(Math.E)};Q.naturalLogarithm=Q.log=Q.ln=function(x){return new ExpantaNum(x).ln()};var OMEGA=.5671432904097838;var f_lambertw=function(z,tol){if(tol===undefined)tol=1e-10;var w;var wn;if(!Number.isFinite(z))return z;if(z===0)return z;if(z===1)return OMEGA;if(z<10)w=0;else w=Math.log(z)-Math.log(Math.log(z));for(var i=0;i<100;++i){wn=(z*Math.exp(-w)+w*w)/(w+1);if(Math.abs(wn-w)<tol*Math.abs(wn))return wn;w=wn}throw Error("Iteration failed to converge: "+z)};var d_lambertw=function(z,tol){if(tol===undefined)tol=1e-10;z=new ExpantaNum(z);var w;var ew,wewz,wn;if(!z.isFinite())return z;if(z===0)return z;if(z===1){return OMEGA}w=ExpantaNum.ln(z);for(var i=0;i<100;++i){ew=ExpantaNum.exp(-w);wewz=w.sub(z.mul(ew));wn=w.sub(wewz.div(w.add(ExpantaNum.ONE).sub(w.add(2).mul(wewz).div(ExpantaNum.mul(2,w).add(2)))));if(ExpantaNum.abs(wn.sub(w)).lt(ExpantaNum.abs(wn).mul(tol)))return wn;w=wn}throw Error("Iteration failed to converge: "+z)};P.lambertw=function(){var x=this.clone();if(x.isNaN())return x;if(x.lt(-.3678794411710499))throw Error("lambertw is unimplemented for results less than -1, sorry!");if(x.gt(ExpantaNum.TETRATED_MAX_SAFE_INTEGER))return x;if(x.gt(ExpantaNum.EE_MAX_SAFE_INTEGER)){x.operator(1,x.operator(1)-1);return x}if(x.gt(ExpantaNum.MAX_SAFE_INTEGER))return d_lambertw(x);else return new ExpantaNum(f_lambertw(x.sign*x.operator(0)))};Q.lambertw=function(x){return new ExpantaNum(x).lambertw()};P.tetrate=P.tetr=function(other,payload){if(payload===undefined)payload=ExpantaNum.ONE;var t=this.clone();other=new ExpantaNum(other);payload=new ExpantaNum(payload);if(payload.neq(ExpantaNum.ONE))other=other.add(payload.slog(t));if(ExpantaNum.debug>=ExpantaNum.NORMAL)console.log(t+"^^"+other);var negln;if(t.isNaN()||other.isNaN()||payload.isNaN())return ExpantaNum.NaN.clone();if(other.isInfinite()&&other.sign>0){if(t.gte(Math.exp(1/Math.E)))return ExpantaNum.POSITIVE_INFINITY.clone();negln=t.ln().neg();return negln.lambertw().div(negln)}if(other.lte(-2))return ExpantaNum.NaN.clone();if(t.eq(ExpantaNum.ZERO)){if(other.eq(ExpantaNum.ZERO))return ExpantaNum.NaN.clone();if(other.mod(2).eq(ExpantaNum.ZERO))return ExpantaNum.ZERO.clone();return ExpantaNum.ONE.clone()}if(t.eq(ExpantaNum.ONE)){if(other.eq(ExpantaNum.ONE.neg()))return ExpantaNum.NaN.clone();return ExpantaNum.ONE.clone()}if(other.eq(ExpantaNum.ONE.neg()))return ExpantaNum.ZERO.clone();if(other.eq(ExpantaNum.ZERO))return ExpantaNum.ONE.clone();if(other.eq(ExpantaNum.ONE))return t;if(other.eq(2))return t.pow(t);if(t.eq(2)){if(other.eq(3))return new ExpantaNum(16);if(other.eq(4))return new ExpantaNum(65536)}var m=t.max(other);if(m.gt("10^^^"+MAX_SAFE_INTEGER))return m;if(m.gt(ExpantaNum.TETRATED_MAX_SAFE_INTEGER)||other.gt(ExpantaNum.MAX_SAFE_INTEGER)){if(this.lt(Math.exp(1/Math.E))){negln=t.ln().neg();return negln.lambertw().div(negln)}var j=t.slog(10).add(other);j.operator(2,(other.operator(2)||0)+1);j.standardize();return j}var y=other.toNumber();var f=Math.floor(y);var r=t.pow(y-f);var l=ExpantaNum.NaN;for(var i=0,m=new ExpantaNum(ExpantaNum.E_MAX_SAFE_INTEGER);f!==0&&r.lt(m)&&i<100;++i){if(f>0){r=t.pow(r);if(l.eq(r)){f=0;break}l=r;--f}else{r=r.logBase(t);if(l.eq(r)){f=0;break}l=r;++f}}if(i==100||this.lt(Math.exp(1/Math.E)))f=0;r.operator(1,r.operator(1)+f||f);r.standardize();return r};Q.tetrate=Q.tetr=function(x,y,payload){return new ExpantaNum(x).tetr(y,payload)};P.iteratedexp=function(other,payload){return this.tetr(other,payload)};Q.iteratedexp=function(x,y,payload){return new ExpantaNum(x).iteratedexp(other,payload)};P.iteratedlog=function(base,other){if(base===undefined)base=10;if(other===undefined)other=ExpantaNum.ONE.clone();var t=this.clone();if(other.eq(0))return t;if(other.eq(1))return t.logBase(base);base=new ExpantaNum(base);other=new ExpantaNum(other);return base.tetr(t.slog(base).sub(other))};Q.iteratedlog=function(x,y,z){return new ExpantaNum(x).iteratedlog(y,z)};P.layeradd=function(other,base){if(base===undefined)base=10;if(other===undefined)other=ExpantaNum.ONE.clone();var t=this.clone();base=new ExpantaNum(base);other=new ExpantaNum(other);return base.tetr(t.slog(base).add(other))};Q.layeradd=function(x,y,z){return new ExpantaNum(x).layeradd(y,z)};P.layeradd10=function(other){return this.layeradd(other)};Q.layeradd10=function(x,y){return new ExpantaNum(x).layeradd10(y)};P.ssqrt=P.ssrt=function(){var x=this.clone();if(x.lt(Math.exp(-1/Math.E)))return ExpantaNum.NaN.clone();if(!x.isFinite())return x;if(x.gt(ExpantaNum.TETRATED_MAX_SAFE_INTEGER))return x;if(x.gt(ExpantaNum.EE_MAX_SAFE_INTEGER)){x.operator(1,x.operator(1)-1);return x}var l=x.ln();return l.div(l.lambertw())};Q.ssqrt=Q.ssrt=function(x){return new ExpantaNum(x).ssqrt()};P.slog=function(base){if(base===undefined)base=10;var x=new ExpantaNum(this);base=new ExpantaNum(base);if(x.isNaN()||base.isNaN()||x.isInfinite()&&base.isInfinite())return ExpantaNum.NaN.clone();if(x.isInfinite())return x;if(base.isInfinite())return ExpantaNum.ZERO.clone();if(x.lt(ExpantaNum.ZERO))return ExpantaNum.ONE.neg();if(x.eq(ExpantaNum.ONE))return ExpantaNum.ZERO.clone();if(x.eq(base))return ExpantaNum.ONE.clone();if(base.lt(Math.exp(1/Math.E))){var a=ExpantaNum.tetr(base,Infinity);if(x.eq(a))return ExpantaNum.POSITIVE_INFINITY.clone();if(x.gt(a))return ExpantaNum.NaN.clone()}if(x.max(base).gt("10^^^"+MAX_SAFE_INTEGER)){if(x.gt(base))return x;return ExpantaNum.ZERO.clone()}if(x.max(base).gt(ExpantaNum.TETRATED_MAX_SAFE_INTEGER)){if(x.gt(base)){x.operator(2,x.operator(2)-1);x.standardize();return x.sub(x.operator(1))}return ExpantaNum.ZERO.clone()}var r=0;var t=(x.operator(1)||0)-(base.operator(1)||0);if(t>3){var l=t-3;r+=l;x.operator(1,x.operator(1)-l)}for(var i=0;i<100;++i){if(x.lt(ExpantaNum.ZERO)){x=ExpantaNum.pow(base,x);--r}else if(x.lte(1)){return new ExpantaNum(r+x.toNumber()-1)}else{++r;x=ExpantaNum.logBase(x,base)}}if(x.gt(10))return new ExpantaNum(r)};Q.slog=function(x,y){return new ExpantaNum(x).slog(y)};P.pentate=P.pent=function(other){return this.arrow(3)(other)};Q.pentate=Q.pent=function(x,y){return ExpantaNum.arrow(x,3,y)};P.arrow=function(arrows){var t=this.clone();arrows=new ExpantaNum(arrows);if(!arrows.isint()||arrows.lt(ExpantaNum.ZERO))return function(other){return ExpantaNum.NaN.clone()};if(arrows.eq(ExpantaNum.ZERO))return function(other){return t.mul(other)};if(arrows.eq(ExpantaNum.ONE))return function(other){return t.pow(other)};if(arrows.eq(2))return function(other){return t.tetr(other)};return function(other){var depth;if(arguments.length==2)depth=arguments[1];else depth=0;other=new ExpantaNum(other);var r;if(ExpantaNum.debug>=ExpantaNum.NORMAL)console.log(t+"{"+arrows+"}"+other);if(t.isNaN()||other.isNaN())return ExpantaNum.NaN.clone();if(other.lt(ExpantaNum.ZERO))return ExpantaNum.NaN.clone();if(t.eq(ExpantaNum.ZERO)){if(other.eq(ExpantaNum.ONE))return ExpantaNum.ZERO.clone();return ExpantaNum.NaN.clone()}if(t.eq(ExpantaNum.ONE))return ExpantaNum.ONE.clone();if(other.eq(ExpantaNum.ZERO))return ExpantaNum.ONE.clone();if(other.eq(ExpantaNum.ONE))return t.clone();if(arrows.gt(ExpantaNum.MAX_SAFE_INTEGER)){r=arrows.clone();r.layer++;return r}if(other.eq(2))return t.arrow(arrows-1)(t,depth+1);if(t.max(other).gt("10{"+arrows.add(ExpantaNum.ONE)+"}"+MAX_SAFE_INTEGER))return t.max(other);if(t.gt("10{"+arrows+"}"+MAX_SAFE_INTEGER)||other.gt(ExpantaNum.MAX_SAFE_INTEGER)){if(t.gt("10{"+arrows+"}"+MAX_SAFE_INTEGER)){r=t.clone();r.operator(arrows,r.operator(arrows)-1);r.standardize()}else if(t.gt("10{"+arrows.sub(ExpantaNum.ONE)+"}"+MAX_SAFE_INTEGER)){r=new ExpantaNum(t.operator(arrows-1))}else{r=ExpantaNum.ZERO}var j=r.add(other);j.operator(arrows,(other.operator(arrows)||0)+1);j.standardize();return j}if(depth>=ExpantaNum.maxOps+10){return new ExpantaNum([[0,10],[Number(arrows),1]])}var y=other.toNumber();var f=Math.floor(y);r=t.arrow(arrows.sub(1))(y-f,depth+1);for(var i=0,m=new ExpantaNum("10{"+arrows.sub(ExpantaNum.ONE)+"}"+MAX_SAFE_INTEGER);f!==0&&r.lt(m)&&i<100;++i){if(f>0){r=t.arrow(arrows.sub(ExpantaNum.ONE))(r,depth+1);--f}}if(i==100)f=0;r.operator(Number(arrows.sub(ExpantaNum.ONE)),r.operator(Number(arrows.sub(ExpantaNum.ONE)))+f||f);r.standardize();return r}};P.chain=function(other,arrows){return this.arrow(arrows)(other)};Q.arrow=function(x,z,y){return new ExpantaNum(x).arrow(z)(y)};Q.chain=function(x,y,z){return new ExpantaNum(x).arrow(z)(y)};Q.hyper=function(z){z=new ExpantaNum(z);if(z.eq(ExpantaNum.ZERO))return function(x,y){return new ExpantaNum(y).eq(ExpantaNum.ZERO)?new ExpantaNum(x):new ExpantaNum(x).add(ExpantaNum.ONE)};if(z.eq(ExpantaNum.ONE))return function(x,y){return ExpantaNum.add(x,y)};return function(x,y){return new ExpantaNum(x).arrow(z.sub(2))(y)}};P.expansion=function(other){var t=this.clone();other=new ExpantaNum(other);var r;if(ExpantaNum.debug>=ExpantaNum.NORMAL)console.log("{"+t+","+other+",1,2}");if(other.lte(ExpantaNum.ZERO)||!other.isint())return ExpantaNum.NaN.clone();if(other.eq(ExpantaNum.ONE))return t.clone();if(!t.isint())return ExpantaNum.NaN.clone();if(t.eq(2))return ExpantaNum(4);if(other.gt(ExpantaNum.MAX_SAFE_INTEGER))return ExpantaNum.POSITIVE_INFINITY.clone();var f=other.toNumber()-1;r=t;for(var i=0;f!==0&&r.lt(ExpantaNum.MAX_SAFE_INTEGER)&&i<100;++i){if(f>0){r=t.arrow(r)(t);--f}}if(i==100)f=0;r.layer+=f;r.standardize();return r};Q.expansion=function(x,y){return new ExpantaNum(x).expansion(y)};Q.affordGeometricSeries=function(resourcesAvailable,priceStart,priceRatio,currentOwned){resourcesAvailable=new ExpantaNum(resourcesAvailable);priceStart=new ExpantaNum(priceStart);priceRatio=new ExpantaNum(priceRatio);var actualStart=priceStart.mul(priceRatio.pow(currentOwned));return ExpantaNum.floor(resourcesAvailable.div(actualStart).mul(priceRatio.sub(ExpantaNum.ONE)).add(ExpantaNum.ONE).log10().div(priceRatio.log10()))};Q.affordArithmeticSeries=function(resourcesAvailable,priceStart,priceAdd,currentOwned){resourcesAvailable=new ExpantaNum(resourcesAvailable);priceStart=new ExpantaNum(priceStart);priceAdd=new ExpantaNum(priceAdd);currentOwned=new ExpantaNum(currentOwned);var actualStart=priceStart.add(currentOwned.mul(priceAdd));var b=actualStart.sub(priceAdd.div(2));var b2=b.pow(2);return b.neg().add(b2.add(priceAdd.mul(resourcesAvailable).mul(2)).sqrt()).div(priceAdd).floor()};Q.sumGeometricSeries=function(numItems,priceStart,priceRatio,currentOwned){priceStart=new ExpantaNum(priceStart);priceRatio=new ExpantaNum(priceRatio);return priceStart.mul(priceRatio.pow(currentOwned)).mul(ExpantaNum.sub(ExpantaNum.ONE,priceRatio.pow(numItems))).div(ExpantaNum.sub(ExpantaNum.ONE,priceRatio))};Q.sumArithmeticSeries=function(numItems,priceStart,priceAdd,currentOwned){numItems=new ExpantaNum(numItems);priceStart=new ExpantaNum(priceStart);currentOwned=new ExpantaNum(currentOwned);var actualStart=priceStart.add(currentOwned.mul(priceAdd));return numItems.div(2).mul(actualStart.mul(2).plus(numItems.sub(ExpantaNum.ONE).mul(priceAdd)))};Q.choose=function(n,k){return new ExpantaNum(n).factorial().div(new ExpantaNum(k).factorial().mul(new ExpantaNum(n).sub(new ExpantaNum(k)).factorial()))};P.choose=function(other){return ExpantaNum.choose(this,other)};P.standardize=function(){var b;var x=this;if(ExpantaNum.debug>=ExpantaNum.ALL)console.log(x.toString());if(!x.array||!x.array.length)x.array=[[0,0]];if(x.sign!=1&&x.sign!=-1){if(typeof x.sign!="number")x.sign=Number(x.sign);x.sign=x.sign<0?-1:1}if(x.layer>MAX_SAFE_INTEGER){x.array=[[0,Infinity]];x.layer=0;return x}for(var i=0;i<x.array.length;++i){var e=x.array[i];if(e[0]===null||e[0]===undefined){e[0]=0}if(e[0]!==0&&(e[1]===0||e[1]===null||e[1]===undefined)){x.array.splice(i,1);--i;continue}if(isNaN(e[0])||isNaN(e[1])){x.array=[[0,NaN]];return x}if(!isFinite(e[0])||!isFinite(e[1])){x.array=[[0,Infinity]];return x}}do{if(ExpantaNum.debug>=ExpantaNum.ALL)console.log(x.toString());b=false;x.array.sort(function(a,b){return a[0]>b[0]?1:a[0]<b[0]?-1:0});if(x.array.length>ExpantaNum.maxOps)x.array.splice(0,x.array.length-ExpantaNum.maxOps);if(!x.array.length)x.array=[[0,0]];if(x.array[x.array.length-1][0]>MAX_SAFE_INTEGER){x.layer++;x.array=[[0,x.array[x.array.length-1][0]]];b=true;continue}else if(x.layer&&x.array.length==1&&x.array[0][0]===0){x.layer--;x.array=[[0,10],[x.array[0][1],1]];b=true;continue}if(x.array.length<ExpantaNum.maxOps&&x.array[0][0]!==0)x.array.unshift([0,10]);for(i=0;i<x.array.length-1;++i){if(x.array[i][0]==x.array[i+1][0]){x.array[i][1]+=x.array[i+1][1];x.array.splice(i+1,1);--i;b=true}}if(x.array[0][0]===0&&x.array[0][1]>MAX_SAFE_INTEGER){if(x.array.length>=2&&x.array[1][0]==1){x.array[1][1]++}else{x.array.splice(1,0,[1,1])}x.array[0][1]=Math.log10(x.array[0][1]);b=true}while(x.array.length>=2&&x.array[0][0]===0&&x.array[0][1]<MAX_E&&x.array[1][0]==1&&x.array[1][1]){x.array[0][1]=Math.pow(10,x.array[0][1]);if(x.array[1][1]>1){x.array[1][1]--}else{x.array.splice(1,1)}b=true}while(x.array.length>=2&&x.array[0][0]===0&&x.array[0][1]==1&&x.array[1][1]){if(x.array[1][1]>1){x.array[1][1]--}else{x.array.splice(1,1)}x.array[0][1]=10}if(x.array.length>=2&&x.array[0][0]===0&&x.array[1][0]!=1){if(x.array[0][1])x.array.splice(1,0,[x.array[1][0]-1,x.array[0][1]]);x.array[0][1]=1;if(x.array[2][1]>1){x.array[2][1]--}else{x.array.splice(2,1)}b=true}for(i=1;i<x.array.length;++i){if(x.array[i][1]>MAX_SAFE_INTEGER){if(i!=x.array.length-1&&x.array[i+1][0]==x.array[i][0]+1){x.array[i+1][1]++}else{x.array.splice(i+1,0,[x.array[i][0]+1,1])}if(x.array[0][0]===0){x.array[0][1]=x.array[i][1]+1}else{x.splice(0,0,[0,x.array[i][1]+1])}x.splice(1,i);b=true}}}while(b);if(!x.array.length)x.array=[[0,0]];return x};P.toNumber=function(){if(this.sign==-1)return-1*this.abs();if(this.array.length>=2&&(this.array[1][0]>=2||this.array[1][1]>=2||this.array[1][1]==1&&this.array[0][1]>Math.log10(Number.MAX_VALUE)))return Infinity;if(this.array.length>=2&&this.array[1][1]==1)return Math.pow(10,this.array[0][1]);return this.array[0][1]};P.toString=function(){if(this.sign==-1)return"-"+this.abs();if(isNaN(this.array[0][1]))return"NaN";if(!isFinite(this.array[0][1]))return"Infinity";var s="";if(!this.layer)s+="";else if(this.layer<3)s+="J".repeat(this.layer);else s+="J^"+this.layer+" ";if(this.array.length>=3||this.array.length==2&&this.array[1][0]>=2){for(var i=this.array.length-1;i>=2;--i){var e=this.array[i];var q=e[0]>=5?"{"+e[0]+"}":"^".repeat(e[0]);if(e[1]>1)s+="(10"+q+")^"+e[1]+" ";else if(e[1]==1)s+="10"+q}}var op0=this.operator(0);var op1=this.operator(1);if(!op1)s+=String(op0);else if(op1<3)s+="e".repeat(op1-1)+Math.pow(10,op0-Math.floor(op0))+"e"+Math.floor(op0);else if(op1<8)s+="e".repeat(op1)+op0;else s+="(10^)^"+op1+" "+op0;return s};var decimalPlaces=function decimalPlaces(value,places){var len=places+1;var numDigits=Math.ceil(Math.log10(Math.abs(value)));var rounded=Math.round(value*Math.pow(10,len-numDigits))*Math.pow(10,numDigits-len);return parseFloat(rounded.toFixed(Math.max(len-numDigits,0)))};P.toStringWithDecimalPlaces=function(places,applyToOpNums){if(this.sign==-1)return"-"+this.abs();if(isNaN(this.array[0][1]))return"NaN";if(!isFinite(this.array[0][1]))return"Infinity";var b=0;var s="";var m=Math.pow(10,places);if(!this.layer)s+="";else if(this.layer<3)s+="J".repeat(this.layer);else s+="J^"+this.layer+" ";if(this.array.length>=3||this.array.length==2&&this.array[1][0]>=2){for(var i=this.array.length-1;!b&&i>=2;--i){var e=this.array[i];var w=e[0];var x=e[1];if(applyToOpNums&&x>=m){++w;b=x;x=1}else if(applyToOpNums&&this.array[i-1][0]==w-1&&this.array[i-1][1]>=m){++x;b=this.array[i-1][1]}var q=w>=5?"{"+w+"}":"^".repeat(w);if(x>1)s+="(10"+q+")^"+x+" ";else if(x==1)s+="10"+q}}var k=this.operator(0);var l=this.operator(1);if(k>m){k=Math.log10(k);++l}if(b)s+=decimalPlaces(b,places);else if(!l)s+=String(decimalPlaces(k,places));else if(l<3)s+="e".repeat(l-1)+decimalPlaces(Math.pow(10,k-Math.floor(k)),places)+"e"+decimalPlaces(Math.floor(k),places);else if(l<8)s+="e".repeat(l)+decimalPlaces(k,places);else if(applyToOpNums)s+="(10^)^"+decimalPlaces(l,places)+" "+decimalPlaces(k,places);else s+="(10^)^"+l+" "+decimalPlaces(k,places);return s};P.toExponential=function(places,applyToOpNums){if(this.array.length==1)return(this.sign*this.array[0][1]).toExponential(places);return this.toStringWithDecimalPlaces(places,applyToOpNums)};P.toFixed=function(places,applyToOpNums){if(this.array.length==1)return(this.sign*this.array[0][1]).toFixed(places);return this.toStringWithDecimalPlaces(places,applyToOpNums)};P.toPrecision=function(places,applyToOpNums){if(this.array[0][1]===0)return(this.sign*this.array[0][1]).toFixed(places-1,applyToOpNums);if(this.array.length==1&&this.array[0][1]<1e-6)return this.toExponential(places-1,applyToOpNums);if(this.array.length==1&&places>Math.log10(this.array[0][1]))return this.toFixed(places-Math.floor(Math.log10(this.array[0][1]))-1,applyToOpNums);return this.toExponential(places-1,applyToOpNums)};P.valueOf=function(){return this.toString()};P.toJSON=function(){if(ExpantaNum.serializeMode==ExpantaNum.JSON){var a=[];for(var i=0;i<this.array.length;++i)a.push([this.array[i][0],this.array[i][1]]);return{array:a,layer:this.layer,sign:this.sign}}else if(ExpantaNum.serializeMode==ExpantaNum.STRING){return this.toString()}};P.toHyperE=function(){if(this.layer)throw Error(expantaNumError+"Sorry, but this prototype doesn't support correct Hyper-E notation for numbers larger than 10{MSI}10");if(this.sign==-1)return"-"+this.abs().toHyperE();if(isNaN(this.array[0][1]))return"NaN";if(!isFinite(this.array[0][1]))return"Infinity";if(this.lt(ExpantaNum.MAX_SAFE_INTEGER))return String(this.array[0][1]);if(this.lt(ExpantaNum.E_MAX_SAFE_INTEGER))return"E"+this.array[0][1];var r="E"+this.operator(0)+"#"+this.operator(1);var l=1;for(var i=Math.ceil(this.getOperatorIndex(2));i<this.array.length;++i){if(l+1<this.array[i][0])r+="#1".repeat(this.array[i][0]-l-1);l=this.array[i][0];r+="#"+(this.array[i][1]+1)}if(!this.layer)r=""+r;else if(this.layer<3)r="J".repeat(this.layer)+r;else r="J^"+this.layer+" "+r;return r};Q.fromNumber=function(input){if(typeof input!="number")throw Error(invalidArgument+"Expected Number");var x=new ExpantaNum;x.array[0][1]=Math.abs(input);x.sign=input<0?-1:1;x.standardize();return x};Q.fromString=function(input){if(typeof input!="string")throw Error(invalidArgument+"Expected String");var isJSON=false;if(typeof input=="string"&&(input[0]=="["||input[0]=="{")){try{JSON.parse(input)}finally{isJSON=true}}if(isJSON){return ExpantaNum.fromJSON(input)}var x=new ExpantaNum;x.array=[[0,0]];if(!isExpantaNum.test(input)){console.warn(expantaNumError+"Malformed input: "+input);x.array=[[0,NaN]];return x}var negateIt=false;if(input[0]=="-"||input[0]=="+"){var numSigns=input.search(/[^-\+]/);var signs=input.substring(0,numSigns);negateIt=signs.match(/-/g).length%2==1;input=input.substring(numSigns)}if(input=="NaN")x.array=[[0,NaN]];else if(input=="Infinity")x.array=[[0,Infinity]];else{var a,b,c,d,i;if(input[0]=="J"){if(input[1]=="^"){a=input.substring(2).search(/[^0-9]/)+2;x.layer=Number(input.substring(2,a));input=input.substring(a+1)}else{a=input.search(/[^J]/);x.layer=a;input=input.substring(a)}}while(input){if(/^\(?10[\^\{]/.test(input)){if(input[0]=="("){input=input.substring(1)}var arrows;if(input[2]=="^"){a=input.substring(2).search(/[^\^]/);arrows=a;b=a+2}else{a=input.indexOf("}");arrows=Number(input.substring(3,a));b=a+1}input=input.substring(b);if(input[0]==")"){a=input.indexOf(" ");c=Number(input.substring(2,a));input=input.substring(a+1)}else{c=1}if(arrows==1){if(x.array.length>=2&&x.array[1][0]==1){x.array[1][1]+=c}else{x.array.splice(1,0,[1,c])}}else if(arrows==2){a=x.array.length>=2&&x.array[1][0]==1?x.array[1][1]:0;b=x.array[0][1];if(b>=1e10)++a;if(b>=10)++a;x.array[0][1]=a;if(x.array.length>=2&&x.array[1][0]==1)x.array.splice(1,1);d=x.getOperatorIndex(2);if(Number.isInteger(d))x.array[d][1]+=c;else x.array.splice(Math.ceil(d),0,[2,c])}else{a=x.operator(arrows-1);b=x.operator(arrows-2);if(b>=10)++a;d=x.getOperatorIndex(arrows);x.array.splice(1,Math.ceil(d)-1);x.array[0][1]=a;if(Number.isInteger(d))x.array[1][1]+=c;else x.array.splice(1,1,[arrows,c])}}else{break}}a=input.split(/[Ee]/);b=[x.array[0][1],0];c=1;for(i=a.length-1;i>=0;--i){if(a[i])d=Number(a[i]);else d=1;if(b[0]<MAX_E&&b[1]===0){b[0]=Math.pow(10,c*b[0])}else if(c==-1){if(b[1]===0){b[0]=Math.pow(10,c*b[0])}else if(b[1]==1&&b[0]<=Math.log10(Number.MAX_VALUE)){b[0]=Math.pow(10,c*Math.pow(10,b[0]))}else{b[0]=0}b[1]=0}else{b[1]++}if(b[1]===0){b[0]*=Number(d)}else if(b[1]==1){b[0]+=Math.log10(Number(d))}else if(b[1]==2&&b[0]<MAX_E+Math.log10(Math.log10(Number(d)))){b[0]+=Math.log10(1+Math.pow(10,Math.log10(Math.log10(Number(d)))-b[0]))}if(b[0]<MAX_E&&b[1]){b[0]=Math.pow(10,b[0]);b[1]--}else if(b[0]>MAX_SAFE_INTEGER){b[0]=Math.log10(b[0]);b[1]++}}x.array[0][1]=b[0];if(b[1]){if(x.array.length>=2&&x.array[1][0]==1)x.array[1][1]+=b[1];else x.array.splice(1,0,[1,b[1]])}}if(negateIt)x.sign*=-1;x.standardize();return x};Q.fromArray=function(input1,input2,input3){var array,layer,sign;if(input1 instanceof Array&&(input2===undefined||typeof input2=="number")&&(input3===undefined||typeof input3=="number")){array=input1;sign=input2;layer=input3||0}else if(typeof input1=="number"&&input2 instanceof Array&&(input3===undefined||typeof input3=="number")){array=input2;sign=input1;layer=input3||0}else if(typeof input1=="number"&&typeof input2=="number"&&input3 instanceof Array){array=input3;sign=input1;layer=input2}else{throw Error(invalidArgument+"Expected an Array [and 1 or 2 Number]")}var x=new ExpantaNum;var i;if(!array.length)x.array=[[0,0]];else if(typeof array[0]=="number"){x.array=[];for(i=0;i<array.length;i++){if(typeof array[i]!="number")throw Error(invalidArgument+"Expected Array of Number");x.array.push([i,array[i]])}}else if(array[0]instanceof Array){x.array=[];for(i=0;i<array.length;i++){if(!(array[i]instanceof Array)||typeof array[i][0]!="number"||typeof array[i][1]!="number")throw Error(invalidArgument+"Expected Array of pair of Number");x.array.push([array[i][0],array[i][1]])}}else throw Error(invalidArgument+"Expected Array of Number or Array of pair of Number");if(sign)x.sign=Number(sign);else x.sign=1;x.standardize();return x};Q.fromObject=function(input){if(typeof input!="object")throw Error(invalidArgument+"Expected Object");if(input===null)return ExpantaNum.ZERO.clone();if(input instanceof Array)return ExpantaNum.fromArray(input);if(input instanceof ExpantaNum)return new ExpantaNum(input);if(!(input.array instanceof Array))throw Error(invalidArgument+"Expected that property 'array' exists");if(input.sign!==undefined&&typeof input.sign!="number")throw Error(invalidArgument+"Expected that property 'sign' is Number");if(input.layer!==undefined&&typeof input.layer!="number")throw Error(invalidArgument+"Expected that property 'layer' is Number");return ExpantaNum.fromArray(input.array,input.sign,input.layer)};Q.fromJSON=function(input){if(typeof input=="object")return ExpantaNum.fromObject(parsedObject);if(typeof input!="string")throw Error(invalidArgument+"Expected String");var parsedObject,x;try{parsedObject=JSON.parse(input)}catch(e){parsedObject=null;throw e}finally{x=ExpantaNum.fromObject(parsedObject)}parsedObject=null;return x};Q.fromHyperE=function(input){if(typeof input!="string")throw Error(invalidArgument+"Expected String");var x=new ExpantaNum;x.array=[[0,0]];if(!/^[-\+]*(0|[1-9]\d*(\.\d*)?|Infinity|NaN|E[1-9]\d*(\.\d*)?(#[1-9]\d*)*)$/.test(input)){console.warn(expantaNumError+"Malformed input: "+input);x.array=[[0,NaN]];return x}var negateIt=false;if(input[0]=="-"||input[0]=="+"){var numSigns=input.search(/[^-\+]/);var signs=input.substring(0,numSigns);negateIt=signs.match(/-/g).length%2===0;input=input.substring(numSigns)}if(input=="NaN")x.array=[[0,NaN]];else if(input=="Infinity")x.array=[[0,Infinity]];else if(input[0]!="E"){x.array[0][1]=Number(input)}else if(input.indexOf("#")==-1){x.array[0][1]=Number(input.substring(1));x.array[1]=[1,1]}else{var array=input.substring(1).split("#");for(var i=0;i<array.length;++i){var t=Number(array[i]);if(i>=2){--t}x.array[i]=[i,t]}}if(negateIt)x.sign*=-1;x.standardize();return x};P.getOperatorIndex=function(i){if(typeof i!="number")i=Number(i);if(!isFinite(i))throw Error(invalidArgument+"Index out of range.");var a=this.array;var min=0,max=a.length-1;if(a[max][0]<i)return max+.5;if(a[min][0]>i)return-.5;while(min!=max){if(a[min][0]==i)return min;if(a[max][0]==i)return max;var mid=Math.floor((min+max)/2);if(min==mid||a[mid][0]==i){min=mid;break}if(a[mid][0]<i)min=mid;if(a[mid][0]>i)max=mid}return a[min][0]==i?min:min+.5};P.getOperator=function(i){if(typeof i!="number")i=Number(i);if(!isFinite(i))throw Error(invalidArgument+"Index out of range.");var ai=this.getOperatorIndex(i);if(Number.isInteger(ai))return this.array[ai][1];else return i===0?10:0};P.setOperator=function(i,value){if(typeof i!="number")i=Number(i);if(!isFinite(i))throw Error(invalidArgument+"Index out of range.");var ai=this.getOperatorIndex(i);if(Number.isInteger(ai))this.array[ai][1]=value;else{ai=Math.ceil(ai);this.array.splice(ai,0,[i,value])}this.standardize()};P.operator=function(i,value){if(value===undefined)return this.getOperator(i);else this.setOperator(i,value)};P.clone=function(){var temp=new ExpantaNum;var array=[];for(var i=0;i<this.array.length;++i)array.push([this.array[i][0],this.array[i][1]]);temp.array=array;temp.sign=this.sign;temp.layer=this.layer;return temp};function clone(obj){var i,p,ps;function ExpantaNum(input,input2){var x=this;if(!(x instanceof ExpantaNum))return new ExpantaNum(input,input2);x.constructor=ExpantaNum;var parsedObject=null;if(typeof input=="string"&&(input[0]=="["||input[0]=="{")){try{parsedObject=JSON.parse(input)}catch(e){}}var temp,temp2,temp3;if(typeof input=="number"&&!(input2 instanceof Array)){temp=ExpantaNum.fromNumber(input)}else if(parsedObject){temp=ExpantaNum.fromObject(parsedObject)}else if(typeof input=="string"&&input[0]=="E"){temp=ExpantaNum.fromHyperE(input)}else if(typeof input=="string"){temp=ExpantaNum.fromString(input)}else if(input instanceof Array||input2 instanceof Array){temp=ExpantaNum.fromArray(input,input2)}else if(input instanceof ExpantaNum){temp=[];for(var i=0;i<input.array.length;++i)temp.push([input.array[i][0],input.array[i][1]]);temp2=input.sign;temp3=input.layer}else if(typeof input=="object"){temp=ExpantaNum.fromObject(input)}else{temp=[[0,NaN]];temp2=1;temp3=0}if(typeof temp2=="undefined"){x.array=temp.array;x.sign=temp.sign;x.layer=temp.layer}else{x.array=temp;x.sign=temp2;x.layer=temp3}return x}ExpantaNum.prototype=P;ExpantaNum.JSON=0;ExpantaNum.STRING=1;ExpantaNum.NONE=0;ExpantaNum.NORMAL=1;ExpantaNum.ALL=2;ExpantaNum.clone=clone;ExpantaNum.config=ExpantaNum.set=config;for(var prop in Q){if(Q.hasOwnProperty(prop)){ExpantaNum[prop]=Q[prop]}}if(obj===void 0)obj={};if(obj){ps=["maxOps","serializeMode","debug"];for(i=0;i<ps.length;)if(!obj.hasOwnProperty(p=ps[i++]))obj[p]=this[p]}ExpantaNum.config(obj);return ExpantaNum}function defineConstants(obj){for(var prop in R){if(R.hasOwnProperty(prop)){if(Object.defineProperty){Object.defineProperty(obj,prop,{configurable:false,enumerable:true,writable:false,value:new ExpantaNum(R[prop])})}else{obj[prop]=new ExpantaNum(R[prop])}}}return obj}function config(obj){if(!obj||typeof obj!=="object"){throw Error(expantaNumError+"Object expected")}var i,p,v,ps=["maxOps",1,Number.MAX_SAFE_INTEGER,"serializeMode",0,1,"debug",0,2];for(i=0;i<ps.length;i+=3){if((v=obj[p=ps[i]])!==void 0){if(Math.floor(v)===v&&v>=ps[i+1]&&v<=ps[i+2])this[p]=v;else throw Error(invalidArgument+p+": "+v)}}return this}ExpantaNum=clone(ExpantaNum);ExpantaNum=defineConstants(ExpantaNum);ExpantaNum["default"]=ExpantaNum.ExpantaNum=ExpantaNum;if(typeof define=="function"&&define.amd){define(function(){return ExpantaNum})}else if(typeof module!="undefined"&&module.exports){module.exports=ExpantaNum}else{if(!globalScope){globalScope=typeof self!="undefined"&&self&&self.self==self?self:Function("return this")()}globalScope.ExpantaNum=ExpantaNum}})(this);
